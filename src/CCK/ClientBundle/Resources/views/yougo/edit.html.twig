{% extends "CCKClientBundle::layout.html.twig" %}

{% block stylesheets %}
	{{ parent() }}
	<style>
.site-header{
    z-index: 30;
    background: #F8F7F2;
    position: fixed;
	width: 1800px;
    justify-content: space-between;
    left: 90px;
    top: 40px;
}
.content{
    line-height: 1.6;
    margin: 0 auto;
    padding-top: 320px;
}
.panel-search {
	width: 1200px;
	margin-left: 60px;
	margin-top: 40px;
}
.panel-search field_title {
    height: 20px;
}
.table-yougo {
	overflow-x: scroll;
    overflow-y: hidden;
	width: 1720px;
}
thead, tbody {
  display: block;
}
tbody {
  overflow-x: hidden;
}
.sort-button {
    width: auto;
    padding:0;
    margin:0;
    background:none;
    border:0;
    overflow:visible;
    cursor:pointer;
    font-size:8px;
}
.sty_list_count {
    width: 60%;
}
	</style>
{% endblock %}

{% block contents %}
<form action="{{ path('client.yougo.edit.confirm') }}" class="form-horizontal" method="GET" autocomplete="off">
<div class="row">
	<div class="col-lg-12">
		<div class="panel-body">
			<div class="row">
				<div class="form-horizontal">
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.term_id'|trans }}</label>
							<label class="col-sm-1">{{ yougo.termId }}</label>
							<label class="col-sm-1">{{ 'text.yougo.curriculum'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-cur input-sm" name="curriculum">
									<option value="0">--------------</option>
									{% for cur in cur_list %}
										<option value="{{ cur.id }}" {{ cur.id == curriculum ? " selected " : '' }}">{{ cur.name }}</option>
									{% endfor %}
								</select>
							</div>
							<label class="col-sm-1">{{ 'text.yougo.version'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-han input-sm" name="version" disabled>
									<option value="0">--------------</option>
									{% for ver in ver_list %}
										<option value="{{ ver.id }}" {{ ver.id == version ? " selected " : '' }}">{{ ver.name }}</option>
									{% endfor %}
								</select>
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.head.hen'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-hen input-sm" name="hen">
									<option value="0">--------------</option>
									{% for hen in hen_list %}
										<option value="{{ hen.hen }}" {{ hen.hen == select_hen ? " selected " : '' }}">{{ hen.name }}</option>
									{% endfor %}
								</select>
							</div>
							<label class="col-sm-1">{{ 'text.yougo.head.sho'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-sho input-sm" name="sho" disabled>
									<option value="0">--------------</option>
									{% for sho in sho_list %}
										<option value="{{ sho.sho }}" {{ sho.sho == select_sho ? " selected " : '' }}">{{ sho.name }}</option>
									{% endfor %}
								</select>
							</div>
							<label class="col-sm-1">{{ 'text.yougo.head.dai'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-dai input-sm" name="dai" disabled>
									<option value="0">--------------</option>
									{% for dai in dai_list %}
										<option value="{{ dai.dai }}" {{ dai.dai == select_dai ? " selected " : '' }}">{{ dai.name }}</option>
									{% endfor %}
								</select>
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.head.chu'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-chu input-sm" name="chu" disabled>
									<option value="0">--------------</option>
									{% for chu in chu_list %}
										<option value="{{ chu.chu }}" {{ chu.chu == select_chu ? " selected " : '' }}">{{ chu.name }}</option>
									{% endfor %}
								</select>
							</div>
							<label class="col-sm-1">{{ 'text.yougo.head.ko'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control js-ko input-sm" name="ko" disabled>
									<option value="0">--------------</option>
									{% for ko in ko_list %}
										<option value="{{ ko.ko }}" {{ ko.ko == select_ko ? " selected " : '' }}">{{ ko.name }}</option>
									{% endfor %}
								</select>
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<div class="col-lg-6">
								<table class="table table-responsive table-striped">
									<tr>
										<td>
											<div id="formsort">
												<select class="form-control" name="s2" size="5" multiple="multiple" onchange="buttonStyle(this,'')" id="SEL">
												{% for print_order_term in print_order_list %}
													<option value="{{ print_order_term.termId }}" {{ print_order_term.termId == term_id ? " selected " : '' }}">{{ print_order_term.mainTerm }}</option>
												{% endfor %}
												</select>
											</div>
										</td>
										<td>
											<input type="button" value="10件上に" id="UPBUTTON10" onclick="optionMove(-10,'')"><br />
											<input type="button" value="上に" id="UPBUTTON" onclick="optionMove(-1,'')"><br />
											<input type="button" value="下に" id="DOWNBUTTON" onclick="optionMove(1,'')"><br />
											<input type="button" value="10件下に" id="DOWNBUTTON10" onclick="optionMove(10,'')"><br />
										</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
					<hr>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.main.term'|trans }}</label>
							<div class="col-sm-4">
								<input type="text" class="form-control input-sm" name="main_term" value="{{ yougo.mainTerm }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.red_letter'|trans }}</label>
							<div class="col-sm-1">
								<input type="checkbox" name="red_letter[]">
							</div>
							<div class="col-sm-1">
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.freq.text'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control input-sm" name="text_freq">
									<option value="0">--------------</option>
									<option value="1" {{ text_freq == '1' ? " selected " : '' }}">A</option>
									<option value="2" {{ text_freq == '2' ? " selected " : '' }}">B</option>
									<option value="3" {{ text_freq == '3' ? " selected " : '' }}">C</option>
								</select>
							</div>
							<label class="col-sm-1">{{ 'text.yougo.freq.center'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="center_freq" value="{{ center_freq }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.news.exam'|trans }}</label>
							<div class="col-sm-2">
								<input type="checkbox" name="news_exam[]">
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.delimiter'|trans }}</label>
							<div class="col-sm-2">
								<select class="form-control input-sm" name="text_freq">
									<option value="0">--------------</option>
									<option value="1" {{ text_freq == '1' ? " selected " : '' }}">なし</option>
									<option value="2" {{ text_freq == '2' ? " selected " : '' }}">（</option>
									<option value="3" {{ text_freq == '3' ? " selected " : '' }}">）（</option>
								</select>
							</div>
							<label class="col-sm-1">{{ 'text.yougo.western_language'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="western_language" value="{{ term }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.birth_year'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="birth_year" value="{{ term }}">
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.kana'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="kana" value="{{ term }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.index_add_letter'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="index_add_letter" value="{{ term }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.index_kana'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="index_kana" value="{{ term }}">
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.index_original_kana'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="index_original_kana" value="{{ term }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.index_original'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="index_original" value="{{ term }}">
							</div>
							<label class="col-sm-1">{{ 'text.yougo.index_abbreviation'|trans }}</label>
							<div class="col-sm-3">
								<input type="text" class="form-control input-sm" name="index_abbreviation" value="{{ term }}">
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.nombre'|trans }}</label>
							<label class="col-sm-1">{{ yougo.nombre }}</label>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-12">
							<label class="col-sm-1">{{ 'text.yougo.term_explain'|trans }}</label>
							<div class="col-sm-9">
								<textarea class="form-control" name="term_explain"></textarea>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
					<hr>
<div class="row">
	<div class="col-lg-12">
		<div class="panel-body">
			<div class="row">
				<div class="form-horizontal">
					<!-- サブ用語 -->
					<div class="form-group">
						<div class="col-lg-12">
							<div id="formarea"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

</form>

<!-- yougo list area -->
<div class="content">

<div class="row">
	<div class="col-lg-12">
	</div>
</div>

</div>

{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script>

	function buttonStyle(O,idx){
		var UpButton = document.getElementById('UPBUTTON'+idx);
		var DownButton = document.getElementById('DOWNBUTTON'+idx);
		for(var i=0;i<O.options.length;i++){
			if(O.options[i].selected){
			if(i!=0) UpButton.disabled = false;
			else UpButton.disabled = true;
			if(i!=(O.options.length-1)) DownButton.disabled = false;
			else DownButton.disabled = true;
			}
		}
	}
	function optionMove(MODE,idx) {
		var O = document.getElementById('SEL'+idx);
		for(var i=0;i<O.options.length;i++)
		if(O.options[i].selected) break;
		var tmpOption = O.removeChild(O.options[i]);
		O.insertBefore(tmpOption,O.options[i+MODE])

		buttonStyle(O,idx);
	}

		$(function(){
			$(window).load(function(){
				var yougo_sub = '{{ yougo_sub|json_encode|raw }}';
				console.log("**サブ用語**");
				console.log(yougo_sub);

				var yougo_sub_parse = JSON.parse(yougo_sub);
				console.log(yougo_sub_parse[0].sub_term);
				console.log(yougo_sub_parse.length);

				for(var i=0; i<yougo_sub_parse.length; i++){
					console.log(yougo_sub_parse[i].sub_term);

					var formarea_start = '<br><div class="row"><div class="col-sm-12"><label class="col-sm-2">サブ用語</label><div class="col-sm-10">';
					var formarea_end = '</div></div></div>';

					$('#formarea').append(formarea_start +
							'<div class="form-group"><div class="col-lg-12">'
							+'<input class="form-control" type="text" name="sub_term" value="' + yougo_sub_parse[i].sub_term  + '">'
							+'<input class="form-control" type="checkbox" name="red_letter[]">'
							+'</div></div>'
							+'<input class="form-control" type="text" name="kana" value="' + yougo_sub_parse[i].kana  + '">'
							+'<select class="form-control" name="delimiter">'
							+'<option value="1" >なし</option>'
							+'<option value="2" >（</option>'
							+'<option value="3" >）（</option>'
							+'</select>'
							+'<input class="form-control" type="text" name="text_frequency" value="' + yougo_sub_parse[i].text_frequency  + '">'
							+'<button type="button" class="btn btn-primary btn-sm js-area-target" area-id="2" data-toggle="modal" area-target="#areaModal">センター頻度</button>'
							+'<input class="form-control" type="text" id="center"  name="center" readonly>'
							+ formarea_end);

				}

			});

			$('.js-cur').bind('change', function(){
				var selected_ver = $(this).val();
				if(selected_ver == '0'){
					$('[name="version"]').val('0');
					$('.js-han').attr("disabled", true);
				}else{
					$('.js-han').attr("disabled", false);
				}
			});

			$('.js-han').bind('change', function(){
				var selected_ver = $(this).val();
				var data = {
						'version': selected_ver
				};
				$.ajax({
					url: "{{ path('client.yougo.hen.ajax') }}",
					data: data,
					method: 'POST',
					success: function(response){
						var options = generateOptions(response);
						injectOption('js-hen', options);
					},
					error: function(response){
					}
				});
			});

			$('.js-hen').bind('change', function(){
				var selected_ver = $('[name="version"]').val();
				var selected_hen = $(this).val();

				if(selected_hen == '0'){
					$('[name="sho"]').val('0');
					$('.js-sho').attr("disabled", true);
				}else{
					$('.js-sho').attr("disabled", false);
				}
				$('[name="dai"]').val('0');
				$('[name="chu"]').val('0');
				$('[name="ko"]').val('0');
				$('.js-dai').attr("disabled", true);
				$('.js-chu').attr("disabled", true);
				$('.js-ko').attr("disabled", true);

				var data = {
						'version': selected_ver,
						'hen': selected_hen
				};
				$.ajax({
					url: "{{ path('client.yougo.sho.ajax') }}",
					data: data,
					method: 'POST',
					success: function(response){
						var options = generateOptions(response);
						injectOption('js-sho', options);
					},
					error: function(response){
					}
				});
			});

			$('.js-sho').bind('change', function(){
				var selected_ver = $('[name="version"]').val();
				var selected_hen = $('[name="hen"]').val();
				var selected_sho = $(this).val();

				if(selected_sho == '0'){
					$('[name="dai"]').val('0');
					$('.js-dai').attr("disabled", true);
				}else{
					$('.js-dai').attr("disabled", false);
				}
				$('[name="chu"]').val('0');
				$('[name="ko"]').val('0');
				$('.js-chu').attr("disabled", true);
				$('.js-ko').attr("disabled", true);

				var data = {
						'version': selected_ver,
						'hen': selected_hen,
						'sho': selected_sho
				};
				$.ajax({
					url: "{{ path('client.yougo.dai.ajax') }}",
					data: data,
					method: 'POST',
					success: function(response){
						var options = generateOptions(response);
						injectOption('js-dai', options);
					},
					error: function(response){
					}
				});
			});

			$('.js-dai').bind('change', function(){
				var selected_ver = $('[name="version"]').val();
				var selected_hen = $('[name="hen"]').val();
				var selected_sho = $('[name="sho"]').val();
				var selected_dai = $(this).val();

				if(selected_dai == '0'){
					$('[name="chu"]').val('0');
					$('.js-chu').attr("disabled", true);
				}else{
					$('.js-chu').attr("disabled", false);
				}
				$('[name="ko"]').val('0');
				$('.js-ko').attr("disabled", true);

				var data = {
						'version': selected_ver,
						'hen': selected_hen,
						'sho': selected_sho,
						'dai': selected_dai
				};
				$.ajax({
					url: "{{ path('client.yougo.chu.ajax') }}",
					data: data,
					method: 'POST',
					success: function(response){
						var options = generateOptions(response);
						injectOption('js-chu', options);
					},
					error: function(response){
					}
				});
			});

			$('.js-chu').bind('change', function(){
				var selected_ver = $('[name="version"]').val();
				var selected_hen = $('[name="hen"]').val();
				var selected_sho = $('[name="sho"]').val();
				var selected_dai = $('[name="dai"]').val();
				var selected_chu = $(this).val();

				if(selected_chu == '0'){
					$('[name="ko"]').val('0');
					$('.js-ko').attr("disabled", true);
				}else{
					$('.js-ko').attr("disabled", false);
				}

				var data = {
						'version': selected_ver,
						'hen': selected_hen,
						'sho': selected_sho,
						'dai': selected_dai,
						'chu': selected_chu
				};
				$.ajax({
					url: "{{ path('client.yougo.ko.ajax') }}",
					data: data,
					method: 'POST',
					success: function(response){
						var options = generateOptions(response);
						injectOption('js-ko', options);
					},
					error: function(response){
					}
				});
			});

			$('.js-list-count').bind('change', function(){
				var form = $(this).closest('form');
				form.submit();
			});
		});

	</script>
{% endblock %}
